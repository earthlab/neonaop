<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Work with NEON AOP hyperspectral data â€¢ neonhs</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Work with NEON AOP hyperspectral data">
<meta property="og:description" content="Work with data from the NEON AOP.
    The National Ecological Observatory Networks (NEONs) Airborne Observation
    Platform (AOP) collects hyperspectral data over NEON's 
    field sites. This package is designed to make these data easier to use. ">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">neonhs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/extracting-hyperspectral-data-for-plant-species-in-neon-ground-plots.html">Extracting hyperspectral data for plant species in NEON ground plots</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/earthlab/neonhs">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="neonhs" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#neonhs" class="anchor"></a>neonhs</h1></div>

<p>The goal of neonhs is to make data from the National Ecological Observatory Network (NEON) Airborne Observation Platform (AOP) hyperspectral instrument easier to use. The NEON AOP collects hyperspectral imagery via its at a 1 meter spatial resolution for 426 different wavelengths.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of neonhs via:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#install.packages('devtools')</span></a>
<a class="sourceLine" id="cb1-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">'earthlab/neonhs'</span>)</a></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div id="create-raster-objects-from-hyperspectral-images" class="section level3">
<h3 class="hasAnchor">
<a href="#create-raster-objects-from-hyperspectral-images" class="anchor"></a>Create raster objects from hyperspectral images</h3>
<p>This is a basic example which shows you how to read some bands from L3 hyperspectral reflectance data as a multi-layer raster:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(neonhs)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(raster)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(viridis)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(sp)</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">path_to_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">'extdata'</span>, <span class="st">'ex.h5'</span>, <span class="dt">package =</span> <span class="st">'neonhs'</span>)</a>
<a class="sourceLine" id="cb2-8" title="8">r &lt;-<span class="st"> </span><span class="kw"><a href="reference/hs_read.html">hs_read</a></span>(path_to_file, <span class="dt">bands =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">400</span>))</a>
<a class="sourceLine" id="cb2-9" title="9">r</a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; class      : RasterBrick </span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; dimensions : 30, 30, 900, 4  (nrow, ncol, ncell, nlayers)</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#&gt; resolution : 1, 1  (x, y)</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#&gt; extent     : 257000, 257030, 4111970, 4112000  (xmin, xmax, ymin, ymax)</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; crs        : +init=epsg:32611 +proj=utm +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt; source     : memory</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; names      : band1_384nm, band50_629nm, band100_879nm, band400_2382nm </span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt; min values :      0.0198,       0.0073,        0.0620,         0.0051 </span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt; max values :      0.1348,       0.1113,        0.6743,         0.2072</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(r, <span class="dt">col =</span> <span class="kw"><a href="https://rdrr.io/pkg/viridis/man/reexports.html">cividis</a></span>(<span class="dv">100</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">box =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="reference/figures/README-plot-1.png" width="100%"></p>
</div>
<div id="extract-spectra-at-spatial-point-locations" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-spectra-at-spatial-point-locations" class="anchor"></a>Extract spectra at spatial point locations</h3>
<p>If you need to extract spectra at spatial points, there is a <code>hs_extract_pts</code> function that extracts values from bands efficiently, without needing to first create a raster object.</p>
<p>For example, we may want to extract spectra for every band at the following two points, defined in a <code>SpatialPointsDataFrame</code>. Note also that we can use the <code>hs_proj4string</code> function to get the proj4string representation of the coordinate reference system used in the hyperspectral image.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">pts &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html">SpatialPointsDataFrame</a></span>(<span class="dt">coords =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">257025</span>, <span class="dv">257011</span>),</a>
<a class="sourceLine" id="cb4-2" title="2">                                                  <span class="dt">y =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4111982</span>, <span class="dv">4111991</span>)), </a>
<a class="sourceLine" id="cb4-3" title="3">                              <span class="dt">data =</span> <span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb4-4" title="4">                              <span class="dt">proj4string =</span> <span class="kw"><a href="https://rdrr.io/pkg/sp/man/CRS-class.html">CRS</a></span>(<span class="kw"><a href="reference/hs_proj4string.html">hs_proj4string</a></span>(path_to_file)))</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(r[[<span class="dv">1</span>]], <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">box =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw"><a href="https://rdrr.io/pkg/raster/man/plot.html">plot</a></span>(pts, <span class="dt">add =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="reference/figures/README-plot_points-1.png" width="100%"></p>
<p>To do this efficiently, you can use <code>hs_extract_pts</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">vals &lt;-<span class="st"> </span><span class="kw"><a href="reference/hs_extract_pts.html">hs_extract_pts</a></span>(path_to_file, <span class="dt">pts =</span> pts, <span class="dt">bands =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">426</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">vals</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#&gt; class       : SpatialPointsDataFrame </span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#&gt; features    : 2 </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#&gt; extent      : 257011, 257025, 4111982, 4111991  (xmin, xmax, ymin, ymax)</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; crs         : +init=epsg:32611 +proj=utm +zone=11 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0 </span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; variables   : 429</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co">#&gt; names       : id, band1_384nm, band2_389nm, band3_394nm, band4_399nm, band5_404nm, band6_409nm, band7_414nm, band8_419nm, band9_424nm, band10_429nm, band11_434nm, band12_439nm, band13_444nm, band14_449nm, ... </span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt; min values  :  1,      0.0889,      0.0734,      0.0574,      0.0579,      0.0528,       0.054,       0.058,      0.0563,      0.0595,        0.062,       0.0618,       0.0637,       0.0642,       0.0637, ... </span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt; max values  :  2,      0.0987,      0.0879,      0.0778,      0.0759,      0.0669,      0.0681,      0.0656,      0.0659,       0.062,        0.063,        0.064,       0.0639,       0.0657,       0.0653, ...</span></a></code></pre></div>
<p>Now we have columns with band indices and wavelengths, which we can use to plot spectra, e.g.,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">vals <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/raster/man/select.html">select</a></span>(id, <span class="kw">starts_with</span>(<span class="st">'band'</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">  </span><span class="kw">gather</span>(band, reflectance, <span class="op">-</span>id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="st">  </span><span class="kw">separate</span>(band, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'index'</span>, <span class="st">'wavelength'</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">wavelength =</span> <span class="kw">parse_number</span>(wavelength)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(wavelength, reflectance, <span class="dt">group =</span> id)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">'Wavelength (nm)'</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">'Reflectance'</span>)</a></code></pre></div>
<p><img src="reference/figures/README-plot_spectra-1.png" width="100%"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/earthlab/neonhs">https://â€‹github.com/â€‹earthlab/â€‹neonhs</a>
</li>
<li>Report a bug at <br><a href="https://github.com/earthlab/neonhs/issues">https://â€‹github.com/â€‹earthlab/â€‹neonhs/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Max Joseph <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7745-9990" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
<li>Leah Wasser <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-8177-6550" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#wip"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP â€“ Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
<li><a href="https://travis-ci.org/earthlab/neonhs"><img src="https://travis-ci.org/earthlab/neonhs.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/earthlab/neonhs"><img src="https://ci.appveyor.com/api/projects/status/github/earthlab/neonhs?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://codecov.io/github/earthlab/neonhs?branch=master"><img src="https://codecov.io/gh/earthlab/neonhs/branch/master/graph/badge.svg" alt="Coverage status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Max Joseph, Leah Wasser.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
